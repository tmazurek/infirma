<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Company Profile - Infirma</title>
  <link rel="stylesheet" href="/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <header>
    <div class="container header-container">
      <div class="d-flex align-center">
        <img src="https://via.placeholder.com/32x32/0078d4/ffffff?text=I" alt="Infirma Logo" class="logo">
        <h1>Infirma</h1>
        <span class="premium-button">Odbierz 500 PLN</span>
      </div>
      <div class="user-menu">
        <i class="fas fa-search icon"></i>
        <i class="far fa-bell icon"></i>
        <i class="far fa-folder icon"></i>
        <i class="fas fa-cog icon"></i>
        <div class="user-profile">
          <span>tmazurek@outlook.com</span>
          <i class="fas fa-chevron-down"></i>
        </div>
      </div>
    </div>
    <nav>
      <div class="container">
        <ul>
          <li><a href="/">Przychody</a></li>
          <li><a href="/expenses">Koszty</a></li>
          <li><a href="/summary">Księgowość</a></li>
          <li><a href="/company-profile" class="active">Firma</a></li>
          <li><a href="/clients">Klienci</a></li>
          <li><a href="/invoices">Faktury</a></li>
        </ul>
      </div>
    </nav>
  </header>

  <main class="container">
    <div class="dashboard-greeting">
      <div class="greeting-text">
        <h1>Profil firmy</h1>
      </div>
      <div class="action-buttons">
        <button class="action-button" id="save-profile-btn">
          <i class="fas fa-save"></i> Zapisz zmiany
        </button>
      </div>
    </div>

    <div id="message-container" class="mb-3" style="display: none;"></div>

    <div class="card">
      <div class="card-header">
        <h2>Dane firmy</h2>
      </div>
      <div class="card-body">
        <div class="tabs">
          <ul class="tab-nav">
            <li class="tab-item active" data-tab="company-info">Informacje o firmie</li>
            <li class="tab-item" data-tab="zus-settings">Ustawienia ZUS</li>
          </ul>

        <form id="company-profile-form" class="mb-3">
          <!-- Hidden field to track active tab -->
          <input type="hidden" id="active_tab" name="active_tab" value="company-info">
          <!-- Company Info Tab -->
          <div id="company-info" class="tab-content active">
            <div class="form-group">
              <label for="company_name">Company Name *</label>
              <input type="text" id="company_name" name="company_name" required>
            </div>

            <div class="form-group">
              <label for="nip">NIP (Tax ID) *</label>
              <input type="text" id="nip" name="nip" required pattern="[0-9]{10}" title="NIP must be 10 digits">
            </div>

            <div class="form-group">
              <label for="street_address">Street Address</label>
              <input type="text" id="street_address" name="street_address">
            </div>

            <div class="form-group">
              <label for="city">City</label>
              <input type="text" id="city" name="city">
            </div>

            <div class="form-group">
              <label for="postal_code">Postal Code</label>
              <input type="text" id="postal_code" name="postal_code" pattern="[0-9]{2}-[0-9]{3}" title="Format: 00-000">
            </div>

            <div class="form-group">
              <label for="bank_account_number">Bank Account Number</label>
              <input type="text" id="bank_account_number" name="bank_account_number">
            </div>

            <div class="form-group">
              <label for="default_vat_rate">Default VAT Rate (%)</label>
              <input type="number" id="default_vat_rate" name="default_vat_rate" min="0" max="100" step="1" value="23">
            </div>
          </div>

          <!-- ZUS Settings Tab -->
          <div id="zus-settings" class="tab-content">
            <h3>ZUS Contribution Settings</h3>
            <p>Configure your ZUS (Social Security) contribution rates and amounts.</p>

            <div class="zus-settings-container">
              <!-- Left Column - All Input Fields -->
              <div class="zus-settings-column inputs-column">
                <div class="zus-settings-card">
                  <h4>Base Settings</h4>
                  <div class="form-group">
                    <label for="zus_base_amount">Base Amount (PLN)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_base_amount" name="zus_base_amount" min="0" step="0.01" value="5203.80">
                      <button type="button" class="reset-btn" data-field="zus_base_amount" data-default="5203.80">Reset</button>
                    </div>
                    <small>The base amount used for calculating ZUS contributions (e.g., 5203.80 PLN for 2025)</small>
                  </div>
                </div>

                <div class="zus-settings-card">
                  <h4>Mandatory Insurance</h4>
                  <div class="form-group">
                    <label for="zus_retirement_rate">Retirement Insurance Rate (%)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_retirement_rate" name="zus_retirement_rate" min="0" max="100" step="0.01" value="19.52">
                      <button type="button" class="reset-btn" data-field="zus_retirement_rate" data-default="19.52">Reset</button>
                    </div>
                    <small>Default: 19.52%</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_disability_rate">Disability Insurance Rate (%)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_disability_rate" name="zus_disability_rate" min="0" max="100" step="0.01" value="8.0">
                      <button type="button" class="reset-btn" data-field="zus_disability_rate" data-default="8.0">Reset</button>
                    </div>
                    <small>Default: 8.0%</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_accident_rate">Accident Insurance Rate (%)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_accident_rate" name="zus_accident_rate" min="0" max="100" step="0.01" value="1.67">
                      <button type="button" class="reset-btn" data-field="zus_accident_rate" data-default="1.67">Reset</button>
                    </div>
                    <small>Default: 1.67%</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_labor_fund_rate">Labor Fund Rate (%)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_labor_fund_rate" name="zus_labor_fund_rate" min="0" max="100" step="0.01" value="2.45">
                      <button type="button" class="reset-btn" data-field="zus_labor_fund_rate" data-default="2.45">Reset</button>
                    </div>
                    <small>Default: 2.45%</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_fep_rate">FEP (Bridging Pensions Fund) Rate (%)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_fep_rate" name="zus_fep_rate" min="0" max="100" step="0.01" value="0.1">
                      <button type="button" class="reset-btn" data-field="zus_fep_rate" data-default="0.1">Reset</button>
                    </div>
                    <small>Default: 0.1%</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_sickness_rate">Sickness Insurance Rate (%) - Optional</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_sickness_rate" name="zus_sickness_rate" min="0" max="100" step="0.01" value="2.45">
                      <button type="button" class="reset-btn" data-field="zus_sickness_rate" data-default="2.45">Reset</button>
                      <button type="button" class="zero-btn" data-field="zus_sickness_rate">Set to 0</button>
                    </div>
                    <small>Default: 2.45% - This insurance is voluntary, set to 0 if you don't want it</small>
                  </div>
                </div>

                <div class="zus-settings-card">
                  <h4>Health Insurance</h4>
                  <div class="form-group">
                    <label for="zus_health_insurance_income_threshold">Health Insurance Income Threshold</label>
                    <select id="zus_health_insurance_income_threshold" name="zus_health_insurance_income_threshold" class="full-width">
                      <option value="low">Up to 60,000 PLN annual income (461.66 PLN monthly)</option>
                      <option value="medium">Between 60,000 and 300,000 PLN annual income (773.23 PLN monthly)</option>
                      <option value="high">Above 300,000 PLN annual income (1,384.97 PLN monthly)</option>
                    </select>
                    <small>Select your annual income threshold for health insurance calculation</small>
                  </div>

                  <div class="form-group">
                    <label for="zus_health_insurance_amount">Custom Health Insurance Amount (PLN)</label>
                    <div class="input-with-reset">
                      <input type="number" id="zus_health_insurance_amount" name="zus_health_insurance_amount" min="0" step="0.01" value="0">
                      <button type="button" class="reset-btn" data-field="zus_health_insurance_amount" data-default="0">Reset</button>
                    </div>
                    <small>Enter a fixed amount, or leave as 0 to use the amount based on income threshold</small>
                  </div>

                  <div class="button-row">
                    <button type="button" id="reset-all-zus" class="btn secondary-btn">Reset All to Defaults</button>
                  </div>
                </div>
              </div>

              <!-- Right Column - Calculations -->
              <div class="zus-settings-column results-column">
                <div class="zus-settings-card calculation-card">
                  <h4>Calculated Monthly Contributions</h4>
                  <div id="zus-calculation-results" class="calculation-results">
                    <!-- Results will be displayed here -->
                  </div>
                </div>
              </div>
            </div>
          </div>

          <button type="submit" class="btn">Zapisz profil firmy</button>
        </form>
        </div>
      </div>
    </div>

      <style>
        /* Tab Styles */
        .tabs {
          width: 100%;
        }

        .tab-nav {
          display: flex;
          list-style: none;
          padding: 0;
          margin-bottom: 20px;
          border-bottom: 1px solid #ddd;
        }

        .tab-item {
          padding: 10px 20px;
          cursor: pointer;
          margin-right: 5px;
          border: 1px solid #ddd;
          border-bottom: none;
          border-radius: 5px 5px 0 0;
          background-color: #f8f9fa;
        }

        .tab-item.active {
          background-color: #fff;
          border-bottom: 1px solid #fff;
          margin-bottom: -1px;
          font-weight: bold;
        }

        .tab-content {
          display: none;
          padding: 20px;
          border: 1px solid #ddd;
          border-top: none;
          border-radius: 0 0 5px 5px;
        }

        .tab-content.active {
          display: block;
        }

        /* Form Styles */
        small {
          display: block;
          color: #6c757d;
          margin-top: 5px;
        }

        /* ZUS Settings Styles */
        .zus-settings-container {
          display: flex;
          flex-wrap: wrap;
          gap: 20px;
          margin-bottom: 20px;
        }

        .zus-settings-column {
          display: flex;
          flex-direction: column;
          gap: 20px;
        }

        .inputs-column {
          flex: 3;
          min-width: 300px;
        }

        .results-column {
          flex: 2;
          min-width: 250px;
        }

        .calculation-card {
          position: sticky;
          top: 20px;
          max-height: calc(100vh - 40px);
          overflow-y: auto;
        }

        .zus-settings-card {
          background-color: #f8f9fa;
          border-radius: 5px;
          padding: 15px;
          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .zus-settings-card h4 {
          margin-top: 0;
          margin-bottom: 15px;
          padding-bottom: 5px;
          border-bottom: 1px solid #ddd;
          color: #495057;
        }

        .input-with-reset {
          display: flex;
          gap: 5px;
          align-items: center;
        }

        .input-with-reset input {
          flex: 1;
        }

        .reset-btn {
          background-color: #e9ecef;
          border: 1px solid #ced4da;
          border-radius: 4px;
          padding: 4px 8px;
          font-size: 0.8em;
          cursor: pointer;
          color: #495057;
        }

        .reset-btn:hover {
          background-color: #dee2e6;
        }

        .zero-btn {
          background-color: #d1ecf1;
          border: 1px solid #bee5eb;
          border-radius: 4px;
          padding: 4px 8px;
          font-size: 0.8em;
          cursor: pointer;
          color: #0c5460;
        }

        .zero-btn:hover {
          background-color: #c3e6cb;
        }

        .full-width {
          width: 100%;
        }

        .calculation-results {
          margin-top: 10px;
        }

        .calculation-results table {
          width: 100%;
          border-collapse: collapse;
          box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }

        .calculation-results table tr:nth-child(even) {
          background-color: #f2f2f2;
        }

        .calculation-results table tr:hover {
          background-color: #e9ecef;
        }

        .calculation-results table tr:last-child {
          font-weight: bold;
          border-top: 2px solid #007bff;
          background-color: #e7f5ff;
        }

        .calculation-results table td {
          padding: 10px;
          border-bottom: 1px solid #dee2e6;
        }

        .calculation-results table td:last-child {
          font-family: monospace;
          font-size: 1.1em;
        }

        .button-row {
          margin-top: 20px;
          display: flex;
          justify-content: center;
        }

        .secondary-btn {
          background-color: #6c757d;
        }

        .secondary-btn:hover {
          background-color: #5a6268;
        }
      </style>
    </section>
  </main>

  <footer class="text-center mt-3">
    <div class="container">
      <p>&copy; 2025 Infirma - Aplikacja księgowa dla polskich przedsiębiorców</p>
    </div>
  </footer>

  <script>
    // Add active class to current nav item
    document.addEventListener('DOMContentLoaded', function() {
      const currentPath = window.location.pathname;
      const navLinks = document.querySelectorAll('nav ul li a');

      navLinks.forEach(link => {
        if (link.getAttribute('href') === currentPath) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });

      // Connect save profile button to form submit
      const saveProfileBtn = document.getElementById('save-profile-btn');
      if (saveProfileBtn) {
        saveProfileBtn.addEventListener('click', function() {
          document.getElementById('company-profile-form').submit();
        });
      }
    });
  </script>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const form = document.getElementById('company-profile-form');
      const messageContainer = document.getElementById('message-container');
      const tabItems = document.querySelectorAll('.tab-item');
      const tabContents = document.querySelectorAll('.tab-content');
      const zusCalculationResults = document.getElementById('zus-calculation-results');

      // Handle tab switching
      tabItems.forEach(item => {
        item.addEventListener('click', function() {
          // Remove active class from all tabs
          tabItems.forEach(tab => tab.classList.remove('active'));
          tabContents.forEach(content => content.classList.remove('active'));

          // Add active class to clicked tab
          this.classList.add('active');

          // Show corresponding content
          const tabId = this.getAttribute('data-tab');
          document.getElementById(tabId).classList.add('active');

          // Update the hidden field to track the active tab
          document.getElementById('active_tab').value = tabId;

          // Update URL with the active tab
          const url = new URL(window.location.href);
          url.searchParams.set('tab', tabId);
          window.history.replaceState({}, '', url);

          // If switching to ZUS tab, calculate and display ZUS contributions
          if (tabId === 'zus-settings') {
            calculateZusContributions();
          }
        });
      });

      // Fetch existing company profile data
      fetchCompanyProfile();

      // Handle form submission
      form.addEventListener('submit', function(e) {
        e.preventDefault();
        saveCompanyProfile();
      });

      // Add input event listeners to ZUS fields for real-time calculation
      const zusFields = [
        'zus_base_amount',
        'zus_retirement_rate',
        'zus_disability_rate',
        'zus_accident_rate',
        'zus_sickness_rate',
        'zus_labor_fund_rate',
        'zus_fep_rate',
        'zus_health_insurance_amount'
      ];

      zusFields.forEach(fieldId => {
        document.getElementById(fieldId).addEventListener('input', calculateZusContributions);
      });

      // Add change event listener to health insurance income threshold select
      document.getElementById('zus_health_insurance_income_threshold').addEventListener('change', calculateZusContributions);

      // Add event listeners to reset buttons
      document.querySelectorAll('.reset-btn').forEach(button => {
        button.addEventListener('click', function() {
          const fieldId = this.getAttribute('data-field');
          const defaultValue = this.getAttribute('data-default');
          document.getElementById(fieldId).value = defaultValue;
          calculateZusContributions();
        });
      });

      // Add event listener to "Set to 0" button for sickness insurance
      document.querySelectorAll('.zero-btn').forEach(button => {
        button.addEventListener('click', function() {
          const fieldId = this.getAttribute('data-field');
          document.getElementById(fieldId).value = 0;
          calculateZusContributions();
        });
      });

      // Add event listener to "Reset All to Defaults" button
      document.getElementById('reset-all-zus').addEventListener('click', function() {
        document.querySelectorAll('.reset-btn').forEach(button => {
          const fieldId = button.getAttribute('data-field');
          const defaultValue = button.getAttribute('data-default');
          document.getElementById(fieldId).value = defaultValue;
        });

        // Reset health insurance income threshold to 'low'
        document.getElementById('zus_health_insurance_income_threshold').value = 'low';

        calculateZusContributions();
        showMessage('success', 'All ZUS settings reset to defaults');
      });

      // Function to fetch company profile
      function fetchCompanyProfile() {
        fetch('/api/company-profile')
          .then(response => {
            if (response.status === 404) {
              // No profile found, that's okay for a new user
              return null;
            }
            if (!response.ok) {
              throw new Error('Failed to fetch company profile');
            }
            return response.json();
          })
          .then(data => {
            if (data) {
              // Populate form with existing data - Company Info
              document.getElementById('company_name').value = data.company_name || '';
              document.getElementById('nip').value = data.nip || '';
              document.getElementById('street_address').value = data.street_address || '';
              document.getElementById('city').value = data.city || '';
              document.getElementById('postal_code').value = data.postal_code || '';
              document.getElementById('bank_account_number').value = data.bank_account_number || '';
              document.getElementById('default_vat_rate').value = data.default_vat_rate || 23;

              // Populate ZUS settings - handle all numeric fields properly, allowing 0 as a valid value
              const setNumericValue = (elementId, value, defaultValue) => {
                document.getElementById(elementId).value = value !== null && value !== undefined ? value : defaultValue;
              };

              setNumericValue('zus_base_amount', data.zus_base_amount, 5203.80);
              setNumericValue('zus_retirement_rate', data.zus_retirement_rate, 19.52);
              setNumericValue('zus_disability_rate', data.zus_disability_rate, 8.0);
              setNumericValue('zus_accident_rate', data.zus_accident_rate, 1.67);
              setNumericValue('zus_sickness_rate', data.zus_sickness_rate, 2.45);
              setNumericValue('zus_labor_fund_rate', data.zus_labor_fund_rate, 2.45);
              setNumericValue('zus_fep_rate', data.zus_fep_rate, 0.1);
              setNumericValue('zus_health_insurance_amount', data.zus_health_insurance_amount, 0);

              // Set health insurance income threshold
              const thresholdSelect = document.getElementById('zus_health_insurance_income_threshold');
              const threshold = data.zus_health_insurance_income_threshold || 'low';
              for (let i = 0; i < thresholdSelect.options.length; i++) {
                if (thresholdSelect.options[i].value === threshold) {
                  thresholdSelect.selectedIndex = i;
                  break;
                }
              }

              // Calculate ZUS contributions
              calculateZusContributions();

              // Check if we need to show the ZUS tab (e.g., if the user was on that tab before refresh)
              const urlParams = new URLSearchParams(window.location.search);
              const activeTab = urlParams.get('tab') || 'company-info';

              // Find and click the tab
              tabItems.forEach(tab => {
                if (tab.getAttribute('data-tab') === activeTab) {
                  tab.click();
                }
              });
            }
          })
          .catch(error => {
            showMessage('error', 'Error loading company profile: ' + error.message);
          });
      }

      // Function to save company profile
      function saveCompanyProfile() {
        const formData = {
          company_name: document.getElementById('company_name').value,
          nip: document.getElementById('nip').value,
          street_address: document.getElementById('street_address').value,
          city: document.getElementById('city').value,
          postal_code: document.getElementById('postal_code').value,
          bank_account_number: document.getElementById('bank_account_number').value,
          default_vat_rate: document.getElementById('default_vat_rate').value,
          zus_base_amount: document.getElementById('zus_base_amount').value,
          zus_retirement_rate: document.getElementById('zus_retirement_rate').value,
          zus_disability_rate: document.getElementById('zus_disability_rate').value,
          zus_accident_rate: document.getElementById('zus_accident_rate').value,
          zus_sickness_rate: document.getElementById('zus_sickness_rate').value,
          zus_labor_fund_rate: document.getElementById('zus_labor_fund_rate').value,
          zus_fep_rate: document.getElementById('zus_fep_rate').value,
          zus_health_insurance_amount: document.getElementById('zus_health_insurance_amount').value,
          zus_health_insurance_income_threshold: document.getElementById('zus_health_insurance_income_threshold').value
        };

        fetch('/api/company-profile', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(formData)
        })
        .then(response => {
          if (!response.ok) {
            return response.json().then(err => {
              throw new Error(err.error || 'Failed to save company profile');
            });
          }
          return response.json();
        })
        .then(data => {
          showMessage('success', data.message);

          // Restore the active tab after saving
          const activeTab = document.getElementById('active_tab').value || 'company-info';

          // Update URL with the active tab
          const url = new URL(window.location.href);
          url.searchParams.set('tab', activeTab);
          window.history.replaceState({}, '', url);

          // Find and click the tab
          tabItems.forEach(tab => {
            if (tab.getAttribute('data-tab') === activeTab) {
              tab.click();
            }
          });
        })
        .catch(error => {
          showMessage('error', error.message);
        });
      }

      // Function to calculate ZUS contributions
      function calculateZusContributions() {
        // Handle all numeric fields properly, allowing 0 as a valid value
        const getNumericValue = (elementId, defaultValue) => {
          const element = document.getElementById(elementId);
          return element.value === '' ? defaultValue : parseFloat(element.value);
        };

        const baseAmount = getNumericValue('zus_base_amount', 5203.80);
        const retirementRate = getNumericValue('zus_retirement_rate', 19.52);
        const disabilityRate = getNumericValue('zus_disability_rate', 8.0);
        const accidentRate = getNumericValue('zus_accident_rate', 1.67);
        const sicknessRate = getNumericValue('zus_sickness_rate', 2.45);
        const laborFundRate = getNumericValue('zus_labor_fund_rate', 2.45);
        const fepRate = getNumericValue('zus_fep_rate', 0.1);
        const healthInsuranceAmount = parseFloat(document.getElementById('zus_health_insurance_amount').value) || 0;

        // Calculate contributions
        const retirement = (baseAmount * retirementRate / 100).toFixed(2);
        const disability = (baseAmount * disabilityRate / 100).toFixed(2);
        const accident = (baseAmount * accidentRate / 100).toFixed(2);
        const sickness = (baseAmount * sicknessRate / 100).toFixed(2);
        const laborFund = (baseAmount * laborFundRate / 100).toFixed(2);
        const fep = (baseAmount * fepRate / 100).toFixed(2);

        // Get health insurance income threshold
        const healthInsuranceThreshold = document.getElementById('zus_health_insurance_income_threshold').value || 'low';

        // Determine health insurance amount based on threshold or custom amount
        let healthInsurance;

        if (healthInsuranceAmount > 0) {
          // Use custom amount if provided
          healthInsurance = healthInsuranceAmount.toFixed(2);
        } else {
          // Use amount based on income threshold
          switch (healthInsuranceThreshold) {
            case 'medium':
              healthInsurance = '773.23';
              break;
            case 'high':
              healthInsurance = '1384.97';
              break;
            default:
              healthInsurance = '461.66';
          }
        }

        // Calculate total
        const socialInsuranceTotal = parseFloat(retirement) + parseFloat(disability) +
                                    parseFloat(accident) + parseFloat(sickness) +
                                    parseFloat(laborFund) + parseFloat(fep);

        const total = socialInsuranceTotal + parseFloat(healthInsurance);

        // Display results
        zusCalculationResults.innerHTML = `
          <table style="width: 100%;">
            <tr>
              <td><strong>Retirement Insurance:</strong></td>
              <td style="text-align: right;">${retirement} PLN</td>
            </tr>
            <tr>
              <td><strong>Disability Insurance:</strong></td>
              <td style="text-align: right;">${disability} PLN</td>
            </tr>
            <tr>
              <td><strong>Accident Insurance:</strong></td>
              <td style="text-align: right;">${accident} PLN</td>
            </tr>
            <tr>
              <td><strong>Sickness Insurance:</strong></td>
              <td style="text-align: right;">${sickness} PLN</td>
            </tr>
            <tr>
              <td><strong>Labor Fund:</strong></td>
              <td style="text-align: right;">${laborFund} PLN</td>
            </tr>
            <tr>
              <td><strong>FEP (Bridging Pensions Fund):</strong></td>
              <td style="text-align: right;">${fep} PLN</td>
            </tr>
            <tr>
              <td><strong>Social Insurance Total:</strong></td>
              <td style="text-align: right;">${socialInsuranceTotal.toFixed(2)} PLN</td>
            </tr>
            <tr>
              <td><strong>Health Insurance:</strong></td>
              <td style="text-align: right;">${healthInsurance} PLN</td>
            </tr>
            <tr style="font-weight: bold; border-top: 1px solid #ddd;">
              <td><strong>TOTAL ZUS MONTHLY PAYMENT:</strong></td>
              <td style="text-align: right;">${total.toFixed(2)} PLN</td>
            </tr>
          </table>
        `;
      }

      // Function to show messages
      function showMessage(type, message) {
        messageContainer.innerHTML = `
          <div class="card mb-3">
            <div class="card-body ${type === 'error' ? 'text-warning' : 'text-success'}">
              <i class="fas ${type === 'error' ? 'fa-exclamation-circle' : 'fa-check-circle'}"></i> ${message}
            </div>
          </div>
        `;
        messageContainer.style.display = 'block';

        // Auto-hide message after 5 seconds
        setTimeout(() => {
          messageContainer.style.display = 'none';
        }, 5000);
      }
    });
  </script>
</body>
</html>
